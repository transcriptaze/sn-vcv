
#include "TF.hpp"

const double TF::Δf = 512.0;
const double TF::FS = 44100.0;

double TF::interpolate(ANTIALIAS mode, const double f) {
    double f0;
    int ix;
    int jx;

    switch (mode) {
    case NONE:
        return 1.0;

    case ANTIALIAS::X1F1:
        f0 = std::fmod(f, FS);
        ix = std::floor(f0 / Δf);
        jx = std::ceil(f0 / Δf);

        if (ix == jx) {
            return std::get<1>(X1F1[ix]);
        } else {
            const auto u = X1F1[ix];
            const auto v = X1F1[jx];

            const double f1 = std::get<0>(u);
            const double f2 = std::get<0>(v);
            const double p = std::get<1>(u);
            const double q = std::get<1>(v);

            return p + (q - p) * (f0 - f1) / (f2 - f1);
        }
        break;

    case ANTIALIAS::X1F2:
        f0 = std::fmod(f, FS);
        ix = std::floor(f0 / Δf);
        jx = std::ceil(f0 / Δf);

        if (ix == jx) {
            const double h = std::get<1>(X1F2[ix]);

            return h * h;
        } else {
            const auto u = X1F2[ix];
            const auto v = X1F2[jx];

            const double f1 = std::get<0>(u);
            const double f2 = std::get<0>(v);
            const double p = std::get<1>(u);
            const double q = std::get<1>(v);
            const double h = p + (q - p) * (f0 - f1) / (f2 - f1);

            return h * h;
        }
        break;

    case ANTIALIAS::X2F1:
        f0 = std::fmod(f, 2.0 * FS);
        ix = std::floor(f0 / Δf);
        jx = std::ceil(f0 / Δf);

        if (ix == jx) {
            return std::get<1>(X1F1[ix]);
        } else {
            const auto u = X1F1[ix];
            const auto v = X1F1[jx];

            const double f1 = std::get<0>(u);
            const double f2 = std::get<0>(v);
            const double p = std::get<1>(u);
            const double q = std::get<1>(v);

            return p + (q - p) * (f0 - f1) / (f2 - f1);
        }
        break;

    default:
        return 1.0;
    }
}

// clang-format off
// 4th order 12.5kHz Butterworth LPF (44.1kHz)
const std::vector<std::tuple<double, double>> TF::X1F1 = {
    {      0.0, 1.00000 },{    512.0, 1.00000 },{   1024.0, 1.00000 },{   1536.0, 1.00000 },
    {   2048.0, 1.00000 },{   2560.0, 1.00000 },{   3072.0, 1.00000 },{   3584.0, 1.00000 },
    {   4096.0, 0.99999 },{   4608.0, 0.99998 },{   5120.0, 0.99996 },{   5632.0, 0.99990 },
    {   6144.0, 0.99979 },{   6656.0, 0.99956 },{   7168.0, 0.99911 },{   7680.0, 0.99826 },
    {   8192.0, 0.99670 },{   8704.0, 0.99385 },{   9216.0, 0.98877 },{   9728.0, 0.97984 },
    {  10240.0, 0.96449 },{  10752.0, 0.93879 },{  11264.0, 0.89752 },{  11776.0, 0.83525 },
    {  12288.0, 0.74918 },{  12800.0, 0.64269 },{  13312.0, 0.52612 },{  13824.0, 0.41247 },
    {  14336.0, 0.31181 },{  14848.0, 0.22873 },{  15360.0, 0.16347 },{  15872.0, 0.11395 },
    {  16384.0, 0.07736 },{  16896.0, 0.05096 },{  17408.0, 0.03238 },{  17920.0, 0.01966 },
    {  18432.0, 0.01126 },{  18944.0, 0.00597 },{  19456.0, 0.00285 },{  19968.0, 0.00116 },
    {  20480.0, 0.00037 },{  20992.0, 0.00008 },{  21504.0, 0.00001 },{  22016.0, 0.00000 },
    {  22528.0, 0.00000 },{  23040.0, 0.00006 },{  23552.0, 0.00031 },{  24064.0, 0.00102 },
    {  24576.0, 0.00255 },{  25088.0, 0.00545 },{  25600.0, 0.01040 },{  26112.0, 0.01832 },
    {  26624.0, 0.03039 },{  27136.0, 0.04809 },{  27648.0, 0.07333 },{  28160.0, 0.10841 },
    {  28672.0, 0.15604 },{  29184.0, 0.21906 },{  29696.0, 0.29972 },{  30208.0, 0.39820 },
    {  30720.0, 0.51059 },{  31232.0, 0.62751 },{  31744.0, 0.73605 },{  32256.0, 0.82519 },
    {  32768.0, 0.89056 },{  33280.0, 0.93433 },{  33792.0, 0.96177 },{  34304.0, 0.97825 },
    {  34816.0, 0.98785 },{  35328.0, 0.99333 },{  35840.0, 0.99641 },{  36352.0, 0.99810 },
    {  36864.0, 0.99903 },{  37376.0, 0.99951 },{  37888.0, 0.99977 },{  38400.0, 0.99989 },
    {  38912.0, 0.99995 },{  39424.0, 0.99998 },{  39936.0, 0.99999 },{  40448.0, 1.00000 },
    {  40960.0, 1.00000 },{  41472.0, 1.00000 },{  41984.0, 1.00000 },{  42496.0, 1.00000 },
    {  43008.0, 1.00000 },{  43520.0, 1.00000 },{  44032.0, 1.00000 },{  44544.0, 1.00000 },
    {  45056.0, 1.00000 },{  45568.0, 1.00000 },{  46080.0, 1.00000 },{  46592.0, 1.00000 },
    {  47104.0, 1.00000 },{  47616.0, 1.00000 },{  48128.0, 0.99999 },{  48640.0, 0.99999 },
    {  49152.0, 0.99996 },{  49664.0, 0.99991 },{  50176.0, 0.99981 },{  50688.0, 0.99960 },
    {  51200.0, 0.99919 },{  51712.0, 0.99841 },{  52224.0, 0.99696 },{  52736.0, 0.99433 },
    {  53248.0, 0.98962 },{  53760.0, 0.98133 },{  54272.0, 0.96702 },{  54784.0, 0.94297 },
    {  55296.0, 0.90410 },{  55808.0, 0.84488 },{  56320.0, 0.76194 },{  56832.0, 0.65770 },
    {  57344.0, 0.54170 },{  57856.0, 0.42698 },{  58368.0, 0.32421 },{  58880.0, 0.23871 },
    {  59392.0, 0.17117 },{  59904.0, 0.11972 },{  60416.0, 0.08158 },{  60928.0, 0.05397 },
    {  61440.0, 0.03447 },{  61952.0, 0.02107 },{  62464.0, 0.01217 },{  62976.0, 0.00653 },
    {  63488.0, 0.00317 },{  64000.0, 0.00132 },{  64512.0, 0.00044 },{  65024.0, 0.00010 },
    {  65536.0, 0.00001 },{  66048.0, 0.00000 },{  66560.0, 0.00000 },{  67072.0, 0.00004 },
    {  67584.0, 0.00026 },{  68096.0, 0.00088 },{  68608.0, 0.00228 },{  69120.0, 0.00496 },
    {  69632.0, 0.00960 },{  70144.0, 0.01706 },{  70656.0, 0.02849 },{  71168.0, 0.04535 },
    {  71680.0, 0.06946 },{  72192.0, 0.10309 },{  72704.0, 0.14889 },{  73216.0, 0.20971 },
    {  73728.0, 0.28795 },{  74240.0, 0.38418 },{  74752.0, 0.49514 },{  75264.0, 0.61217 },
    {  75776.0, 0.72257 },{  76288.0, 0.81470 },{  76800.0, 0.88322 },{  77312.0, 0.92958 },
    {  77824.0, 0.95886 },{  78336.0, 0.97653 },{  78848.0, 0.98686 },{  79360.0, 0.99277 },
    {  79872.0, 0.99609 },{  80384.0, 0.99793 },{  80896.0, 0.99893 },{  81408.0, 0.99947 },
    {  81920.0, 0.99974 },{  82432.0, 0.99988 },{  82944.0, 0.99995 },{  83456.0, 0.99998 },
    {  83968.0, 0.99999 },{  84480.0, 1.00000 },{  84992.0, 1.00000 },{  85504.0, 1.00000 },
    {  86016.0, 1.00000 },{  86528.0, 1.00000 },{  87040.0, 1.00000 },{  87552.0, 1.00000 },
    {  88064.0, 1.00000 },{  88576.0, 1.00000 },{  89088.0, 1.00000 },{  89600.0, 1.00000 },
    {  90112.0, 1.00000 },{  90624.0, 1.00000 },{  91136.0, 1.00000 },{  91648.0, 1.00000 },
    {  92160.0, 1.00000 },{  92672.0, 0.99999 },{  93184.0, 0.99997 },{  93696.0, 0.99992 },
    {  94208.0, 0.99983 },{  94720.0, 0.99964 },{  95232.0, 0.99926 },{  95744.0, 0.99854 },
    {  96256.0, 0.99721 },{  96768.0, 0.99477 },{  97280.0, 0.99041 },{  97792.0, 0.98271 },
    {  98304.0, 0.96939 },{  98816.0, 0.94690 },{  99328.0, 0.91032 },{  99840.0, 0.85408 },
    { 100352.0, 0.77431 },{ 100864.0, 0.67249 },{ 101376.0, 0.55732 },{ 101888.0, 0.44171 },
    { 102400.0, 0.33692 },{ 102912.0, 0.24901 },{ 103424.0, 0.17916 },{ 103936.0, 0.12572 },
    { 104448.0, 0.08598 },{ 104960.0, 0.05712 },{ 105472.0, 0.03667 },{ 105984.0, 0.02256 },
    { 106496.0, 0.01314 },{ 107008.0, 0.00713 },{ 107520.0, 0.00351 },{ 108032.0, 0.00150 },
    { 108544.0, 0.00052 },{ 109056.0, 0.00012 },{ 109568.0, 0.00001 },{ 110080.0, 0.00000 },
    { 110592.0, 0.00000 },{ 111104.0, 0.00003 },{ 111616.0, 0.00021 },{ 112128.0, 0.00077 },
    { 112640.0, 0.00204 },{ 113152.0, 0.00451 },{ 113664.0, 0.00884 },{ 114176.0, 0.01587 },
    { 114688.0, 0.02670 },{ 115200.0, 0.04274 },{ 115712.0, 0.06577 },{ 116224.0, 0.09798 },
    { 116736.0, 0.14200 },{ 117248.0, 0.20067 },{ 117760.0, 0.27651 },{ 118272.0, 0.37043 },
    { 118784.0, 0.47981 },{ 119296.0, 0.59672 },{ 119808.0, 0.70875 },{ 120320.0, 0.80379 },
    { 120832.0, 0.87548 },{ 121344.0, 0.92453 },{ 121856.0, 0.95575 },{ 122368.0, 0.97468 },
    { 122880.0, 0.98579 },{ 123392.0, 0.99216 },{ 123904.0, 0.99576 },{ 124416.0, 0.99775 },
    { 124928.0, 0.99883 },{ 125440.0, 0.99941 },{ 125952.0, 0.99972 },{ 126464.0, 0.99987 },
    { 126976.0, 0.99994 },{ 127488.0, 0.99998 },{ 128000.0, 0.99999 },{ 128512.0, 1.00000 },
    { 129024.0, 1.00000 },{ 129536.0, 1.00000 },{ 130048.0, 1.00000 },{ 130560.0, 1.00000 },
};

// 2x16kHz, 4 pole Butterworth LPF transfer function (44.1kHz)
const std::vector<std::tuple<double, double>> TF::X1F2 = {
    {      0.0, 1.00000 },{    512.0, 1.00000 },{   1024.0, 1.00000 },{   1536.0, 1.00000 },
    {   2048.0, 1.00000 },{   2560.0, 1.00000 },{   3072.0, 1.00000 },{   3584.0, 1.00000 },
    {   4096.0, 1.00000 },{   4608.0, 1.00000 },{   5120.0, 1.00000 },{   5632.0, 1.00000 },
    {   6144.0, 1.00000 },{   6656.0, 0.99999 },{   7168.0, 0.99998 },{   7680.0, 0.99996 },
    {   8192.0, 0.99993 },{   8704.0, 0.99987 },{   9216.0, 0.99975 },{   9728.0, 0.99955 },
    {  10240.0, 0.99919 },{  10752.0, 0.99854 },{  11264.0, 0.99738 },{  11776.0, 0.99531 },
    {  12288.0, 0.99157 },{  12800.0, 0.98479 },{  13312.0, 0.97238 },{  13824.0, 0.94964 },
    {  14336.0, 0.90831 },{  14848.0, 0.83547 },{  15360.0, 0.71635 },{  15872.0, 0.54753 },
    {  16384.0, 0.35644 },{  16896.0, 0.19325 },{  17408.0, 0.08802 },{  17920.0, 0.03434 },
    {  18432.0, 0.01153 },{  18944.0, 0.00327 },{  19456.0, 0.00075 },{  19968.0, 0.00012 },
    {  20480.0, 0.00001 },{  20992.0, 0.00000 },{  21504.0, 0.00000 },{  22016.0, 0.00000 },
    {  22528.0, 0.00000 },{  23040.0, 0.00000 },{  23552.0, 0.00001 },{  24064.0, 0.00009 },
    {  24576.0, 0.00060 },{  25088.0, 0.00272 },{  25600.0, 0.00986 },{  26112.0, 0.02997 },
    {  26624.0, 0.07835 },{  27136.0, 0.17576 },{  27648.0, 0.33212 },{  28160.0, 0.52242 },
    {  28672.0, 0.69657 },{  29184.0, 0.82260 },{  29696.0, 0.90078 },{  30208.0, 0.94546 },
    {  30720.0, 0.97009 },{  31232.0, 0.98354 },{  31744.0, 0.99089 },{  32256.0, 0.99493 },
    {  32768.0, 0.99717 },{  33280.0, 0.99842 },{  33792.0, 0.99912 },{  34304.0, 0.99951 },
    {  34816.0, 0.99973 },{  35328.0, 0.99985 },{  35840.0, 0.99992 },{  36352.0, 0.99996 },
    {  36864.0, 0.99998 },{  37376.0, 0.99999 },{  37888.0, 0.99999 },{  38400.0, 1.00000 },
    {  38912.0, 1.00000 },{  39424.0, 1.00000 },{  39936.0, 1.00000 },{  40448.0, 1.00000 },
    {  40960.0, 1.00000 },{  41472.0, 1.00000 },{  41984.0, 1.00000 },{  42496.0, 1.00000 },
    {  43008.0, 1.00000 },{  43520.0, 1.00000 },{  44032.0, 1.00000 },{  44544.0, 1.00000 },
    {  45056.0, 1.00000 },{  45568.0, 1.00000 },{  46080.0, 1.00000 },{  46592.0, 1.00000 },
    {  47104.0, 1.00000 },{  47616.0, 1.00000 },{  48128.0, 1.00000 },{  48640.0, 1.00000 },
    {  49152.0, 1.00000 },{  49664.0, 1.00000 },{  50176.0, 1.00000 },{  50688.0, 0.99999 },
    {  51200.0, 0.99998 },{  51712.0, 0.99997 },{  52224.0, 0.99993 },{  52736.0, 0.99988 },
    {  53248.0, 0.99977 },{  53760.0, 0.99958 },{  54272.0, 0.99925 },{  54784.0, 0.99865 },
    {  55296.0, 0.99758 },{  55808.0, 0.99566 },{  56320.0, 0.99221 },{  56832.0, 0.98594 },
    {  57344.0, 0.97449 },{  57856.0, 0.95351 },{  58368.0, 0.91529 },{  58880.0, 0.84752 },
    {  59392.0, 0.73520 },{  59904.0, 0.57221 },{  60416.0, 0.38130 },{  60928.0, 0.21182 },
    {  61440.0, 0.09862 },{  61952.0, 0.03924 },{  62464.0, 0.01345 },{  62976.0, 0.00391 },
    {  63488.0, 0.00092 },{  64000.0, 0.00016 },{  64512.0, 0.00002 },{  65024.0, 0.00000 },
    {  65536.0, 0.00000 },{  66048.0, 0.00000 },{  66560.0, 0.00000 },{  67072.0, 0.00000 },
    {  67584.0, 0.00001 },{  68096.0, 0.00007 },{  68608.0, 0.00048 },{  69120.0, 0.00226 },
    {  69632.0, 0.00840 },{  70144.0, 0.02608 },{  70656.0, 0.06955 },{  71168.0, 0.15937 },
    {  71680.0, 0.30844 },{  72192.0, 0.49700 },{  72704.0, 0.67589 },{  73216.0, 0.80886 },
    {  73728.0, 0.89267 },{  74240.0, 0.94093 },{  74752.0, 0.96761 },{  75264.0, 0.98219 },
    {  75776.0, 0.99015 },{  76288.0, 0.99452 },{  76800.0, 0.99694 },{  77312.0, 0.99829 },
    {  77824.0, 0.99905 },{  78336.0, 0.99947 },{  78848.0, 0.99971 },{  79360.0, 0.99984 },
    {  79872.0, 0.99991 },{  80384.0, 0.99995 },{  80896.0, 0.99998 },{  81408.0, 0.99999 },
    {  81920.0, 0.99999 },{  82432.0, 1.00000 },{  82944.0, 1.00000 },{  83456.0, 1.00000 },
    {  83968.0, 1.00000 },{  84480.0, 1.00000 },{  84992.0, 1.00000 },{  85504.0, 1.00000 },
    {  86016.0, 1.00000 },{  86528.0, 1.00000 },{  87040.0, 1.00000 },{  87552.0, 1.00000 },
    {  88064.0, 1.00000 },{  88576.0, 1.00000 },{  89088.0, 1.00000 },{  89600.0, 1.00000 },
    {  90112.0, 1.00000 },{  90624.0, 1.00000 },{  91136.0, 1.00000 },{  91648.0, 1.00000 },
    {  92160.0, 1.00000 },{  92672.0, 1.00000 },{  93184.0, 1.00000 },{  93696.0, 1.00000 },
    {  94208.0, 1.00000 },{  94720.0, 0.99999 },{  95232.0, 0.99998 },{  95744.0, 0.99997 },
    {  96256.0, 0.99994 },{  96768.0, 0.99989 },{  97280.0, 0.99979 },{  97792.0, 0.99961 },
    {  98304.0, 0.99930 },{  98816.0, 0.99875 },{  99328.0, 0.99776 },{  99840.0, 0.99598 },
    { 100352.0, 0.99279 },{ 100864.0, 0.98700 },{ 101376.0, 0.97644 },{ 101888.0, 0.95708 },
    { 102400.0, 0.92175 },{ 102912.0, 0.85877 },{ 103424.0, 0.75311 },{ 103936.0, 0.59634 },
    { 104448.0, 0.40656 },{ 104960.0, 0.23145 },{ 105472.0, 0.11020 },{ 105984.0, 0.04473 },
    { 106496.0, 0.01564 },{ 107008.0, 0.00466 },{ 107520.0, 0.00113 },{ 108032.0, 0.00021 },
    { 108544.0, 0.00002 },{ 109056.0, 0.00000 },{ 109568.0, 0.00000 },{ 110080.0, 0.00000 },
    { 110592.0, 0.00000 },{ 111104.0, 0.00000 },{ 111616.0, 0.00000 },{ 112128.0, 0.00005 },
    { 112640.0, 0.00038 },{ 113152.0, 0.00187 },{ 113664.0, 0.00714 },{ 114176.0, 0.02264 },
    { 114688.0, 0.06158 },{ 115200.0, 0.14408 },{ 115712.0, 0.28551 },{ 116224.0, 0.47137 },
    { 116736.0, 0.65434 },{ 117248.0, 0.79423 },{ 117760.0, 0.88393 },{ 118272.0, 0.93602 },
    { 118784.0, 0.96493 },{ 119296.0, 0.98072 },{ 119808.0, 0.98934 },{ 120320.0, 0.99408 },
    { 120832.0, 0.99670 },{ 121344.0, 0.99816 },{ 121856.0, 0.99897 },{ 122368.0, 0.99943 },
    { 122880.0, 0.99968 },{ 123392.0, 0.99983 },{ 123904.0, 0.99991 },{ 124416.0, 0.99995 },
    { 124928.0, 0.99997 },{ 125440.0, 0.99999 },{ 125952.0, 0.99999 },{ 126464.0, 1.00000 },
    { 126976.0, 1.00000 },{ 127488.0, 1.00000 },{ 128000.0, 1.00000 },{ 128512.0, 1.00000 },
    { 129024.0, 1.00000 },{ 129536.0, 1.00000 },{ 130048.0, 1.00000 },{ 130560.0, 1.00000 },
};

// 2x oversampling, 4th order 16kHz Butterworth LPF (44.1kHz)
const std::vector<std::tuple<double, double>> TF::X2F1 = {
    {      0.0, 1.00000 },{    512.0, 1.00000 },{   1024.0, 1.00000 },{   1536.0, 1.00000 },
    {   2048.0, 1.00000 },{   2560.0, 1.00000 },{   3072.0, 1.00000 },{   3584.0, 1.00000 },
    {   4096.0, 1.00000 },{   4608.0, 0.99999 },{   5120.0, 0.99998 },{   5632.0, 0.99995 },
    {   6144.0, 0.99989 },{   6656.0, 0.99980 },{   7168.0, 0.99962 },{   7680.0, 0.99933 },
    {   8192.0, 0.99884 },{   8704.0, 0.99806 },{   9216.0, 0.99683 },{   9728.0, 0.99496 },
    {  10240.0, 0.99215 },{  10752.0, 0.98802 },{  11264.0, 0.98205 },{  11776.0, 0.97360 },
    {  12288.0, 0.96187 },{  12800.0, 0.94594 },{  13312.0, 0.92482 },{  13824.0, 0.89759 },
    {  14336.0, 0.86355 },{  14848.0, 0.82246 },{  15360.0, 0.77466 },{  15872.0, 0.72118 },
    {  16384.0, 0.66365 },{  16896.0, 0.60404 },{  17408.0, 0.54436 },{  17920.0, 0.48640 },
    {  18432.0, 0.43153 },{  18944.0, 0.38066 },{  19456.0, 0.33428 },{  19968.0, 0.29252 },
    {  20480.0, 0.25529 },{  20992.0, 0.22234 },{  21504.0, 0.19333 },{  22016.0, 0.16787 },
    {  22528.0, 0.14560 },{  23040.0, 0.12615 },{  23552.0, 0.10918 },{  24064.0, 0.09439 },
    {  24576.0, 0.08151 },{  25088.0, 0.07030 },{  25600.0, 0.06055 },{  26112.0, 0.05206 },
    {  26624.0, 0.04469 },{  27136.0, 0.03828 },{  27648.0, 0.03272 },{  28160.0, 0.02790 },
    {  28672.0, 0.02372 },{  29184.0, 0.02011 },{  29696.0, 0.01699 },{  30208.0, 0.01430 },
    {  30720.0, 0.01198 },{  31232.0, 0.00999 },{  31744.0, 0.00829 },{  32256.0, 0.00684 },
    {  32768.0, 0.00561 },{  33280.0, 0.00457 },{  33792.0, 0.00369 },{  34304.0, 0.00295 },
    {  34816.0, 0.00234 },{  35328.0, 0.00184 },{  35840.0, 0.00142 },{  36352.0, 0.00108 },
    {  36864.0, 0.00081 },{  37376.0, 0.00060 },{  37888.0, 0.00043 },{  38400.0, 0.00030 },
    {  38912.0, 0.00021 },{  39424.0, 0.00013 },{  39936.0, 0.00008 },{  40448.0, 0.00005 },
    {  40960.0, 0.00003 },{  41472.0, 0.00001 },{  41984.0, 0.00001 },{  42496.0, 0.00000 },
    {  43008.0, 0.00000 },{  43520.0, 0.00000 },{  44032.0, 0.00000 },{  44544.0, 0.00000 },
    {  45056.0, 0.00000 },{  45568.0, 0.00000 },{  46080.0, 0.00000 },{  46592.0, 0.00001 },
    {  47104.0, 0.00002 },{  47616.0, 0.00004 },{  48128.0, 0.00007 },{  48640.0, 0.00012 },
    {  49152.0, 0.00018 },{  49664.0, 0.00027 },{  50176.0, 0.00039 },{  50688.0, 0.00055 },
    {  51200.0, 0.00075 },{  51712.0, 0.00101 },{  52224.0, 0.00133 },{  52736.0, 0.00172 },
    {  53248.0, 0.00220 },{  53760.0, 0.00278 },{  54272.0, 0.00348 },{  54784.0, 0.00432 },
    {  55296.0, 0.00532 },{  55808.0, 0.00650 },{  56320.0, 0.00789 },{  56832.0, 0.00952 },
    {  57344.0, 0.01142 },{  57856.0, 0.01365 },{  58368.0, 0.01623 },{  58880.0, 0.01923 },
    {  59392.0, 0.02271 },{  59904.0, 0.02673 },{  60416.0, 0.03137 },{  60928.0, 0.03673 },
    {  61440.0, 0.04290 },{  61952.0, 0.05000 },{  62464.0, 0.05818 },{  62976.0, 0.06758 },
    {  63488.0, 0.07838 },{  64000.0, 0.09080 },{  64512.0, 0.10505 },{  65024.0, 0.12141 },
    {  65536.0, 0.14017 },{  66048.0, 0.16166 },{  66560.0, 0.18623 },{  67072.0, 0.21427 },
    {  67584.0, 0.24614 },{  68096.0, 0.28220 },{  68608.0, 0.32273 },{  69120.0, 0.36789 },
    {  69632.0, 0.41760 },{  70144.0, 0.47148 },{  70656.0, 0.52873 },{  71168.0, 0.58812 },
    {  71680.0, 0.64794 },{  72192.0, 0.70622 },{  72704.0, 0.76095 },{  73216.0, 0.81039 },
    {  73728.0, 0.85332 },{  74240.0, 0.88923 },{  74752.0, 0.91821 },{  75264.0, 0.94087 },
    {  75776.0, 0.95809 },{  76288.0, 0.97084 },{  76800.0, 0.98008 },{  77312.0, 0.98664 },
    {  77824.0, 0.99120 },{  78336.0, 0.99432 },{  78848.0, 0.99641 },{  79360.0, 0.99778 },
    {  79872.0, 0.99866 },{  80384.0, 0.99922 },{  80896.0, 0.99956 },{  81408.0, 0.99976 },
    {  81920.0, 0.99987 },{  82432.0, 0.99994 },{  82944.0, 0.99997 },{  83456.0, 0.99999 },
    {  83968.0, 1.00000 },{  84480.0, 1.00000 },{  84992.0, 1.00000 },{  85504.0, 1.00000 },
    {  86016.0, 1.00000 },{  86528.0, 1.00000 },{  87040.0, 1.00000 },{  87552.0, 1.00000 },
    {  88064.0, 1.00000 },{  88576.0, 1.00000 },{  89088.0, 1.00000 },{  89600.0, 1.00000 },
    {  90112.0, 1.00000 },{  90624.0, 1.00000 },{  91136.0, 1.00000 },{  91648.0, 1.00000 },
    {  92160.0, 1.00000 },{  92672.0, 0.99999 },{  93184.0, 0.99998 },{  93696.0, 0.99996 },
    {  94208.0, 0.99991 },{  94720.0, 0.99983 },{  95232.0, 0.99968 },{  95744.0, 0.99942 },
    {  96256.0, 0.99899 },{  96768.0, 0.99830 },{  97280.0, 0.99721 },{  97792.0, 0.99554 },
    {  98304.0, 0.99301 },{  98816.0, 0.98927 },{  99328.0, 0.98385 },{  99840.0, 0.97613 },
    { 100352.0, 0.96536 },{ 100864.0, 0.95063 },{ 101376.0, 0.93099 },{ 101888.0, 0.90546 },
    { 102400.0, 0.87328 },{ 102912.0, 0.83405 },{ 103424.0, 0.78796 },{ 103936.0, 0.73586 },
    { 104448.0, 0.67922 },{ 104960.0, 0.61996 },{ 105472.0, 0.56011 },{ 105984.0, 0.50154 },
    { 106496.0, 0.44574 },{ 107008.0, 0.39375 },{ 107520.0, 0.34615 },{ 108032.0, 0.30316 },
    { 108544.0, 0.26475 },{ 109056.0, 0.23070 },{ 109568.0, 0.20067 },{ 110080.0, 0.17431 },
    { 110592.0, 0.15123 },{ 111104.0, 0.13106 },{ 111616.0, 0.11346 },{ 112128.0, 0.09812 },
    { 112640.0, 0.08476 },{ 113152.0, 0.07313 },{ 113664.0, 0.06301 },{ 114176.0, 0.05420 },
    { 114688.0, 0.04655 },{ 115200.0, 0.03990 },{ 115712.0, 0.03412 },{ 116224.0, 0.02911 },
    { 116736.0, 0.02477 },{ 117248.0, 0.02102 },{ 117760.0, 0.01777 },{ 118272.0, 0.01497 },
    { 118784.0, 0.01256 },{ 119296.0, 0.01049 },{ 119808.0, 0.00872 },{ 120320.0, 0.00721 },
    { 120832.0, 0.00592 },{ 121344.0, 0.00483 },{ 121856.0, 0.00391 },{ 122368.0, 0.00314 },
    { 122880.0, 0.00249 },{ 123392.0, 0.00196 },{ 123904.0, 0.00152 },{ 124416.0, 0.00117 },
    { 124928.0, 0.00088 },{ 125440.0, 0.00065 },{ 125952.0, 0.00047 },{ 126464.0, 0.00033 },
    { 126976.0, 0.00023 },{ 127488.0, 0.00015 },{ 128000.0, 0.00010 },{ 128512.0, 0.00006 },
    { 129024.0, 0.00003 },{ 129536.0, 0.00002 },{ 130048.0, 0.00001 },{ 130560.0, 0.00000 },
};

// 2x oversampling, 2x 4th order 16kHz Butterworth LPF (44.1kHz)
const std::vector<std::tuple<double, double>> TF::X2F2 = {
    {      0.0, 1.00000 },{    512.0, 1.00000 },{   1024.0, 1.00000 },{   1536.0, 1.00000 },
    {   2048.0, 1.00000 },{   2560.0, 1.00000 },{   3072.0, 1.00000 },{   3584.0, 1.00000 },
    {   4096.0, 0.99999 },{   4608.0, 0.99998 },{   5120.0, 0.99995 },{   5632.0, 0.99990 },
    {   6144.0, 0.99979 },{   6656.0, 0.99959 },{   7168.0, 0.99924 },{   7680.0, 0.99865 },
    {   8192.0, 0.99768 },{   8704.0, 0.99611 },{   9216.0, 0.99367 },{   9728.0, 0.98995 },
    {  10240.0, 0.98437 },{  10752.0, 0.97618 },{  11264.0, 0.96443 },{  11776.0, 0.94790 },
    {  12288.0, 0.92520 },{  12800.0, 0.89479 },{  13312.0, 0.85528 },{  13824.0, 0.80566 },
    {  14336.0, 0.74572 },{  14848.0, 0.67644 },{  15360.0, 0.60009 },{  15872.0, 0.52010 },
    {  16384.0, 0.44043 },{  16896.0, 0.36487 },{  17408.0, 0.29633 },{  17920.0, 0.23659 },
    {  18432.0, 0.18622 },{  18944.0, 0.14490 },{  19456.0, 0.11174 },{  19968.0, 0.08557 },
    {  20480.0, 0.06518 },{  20992.0, 0.04944 },{  21504.0, 0.03738 },{  22016.0, 0.02818 },
    {  22528.0, 0.02120 },{  23040.0, 0.01591 },{  23552.0, 0.01192 },{  24064.0, 0.00891 },
    {  24576.0, 0.00664 },{  25088.0, 0.00494 },{  25600.0, 0.00367 },{  26112.0, 0.00271 },
    {  26624.0, 0.00200 },{  27136.0, 0.00147 },{  27648.0, 0.00107 },{  28160.0, 0.00078 },
    {  28672.0, 0.00056 },{  29184.0, 0.00040 },{  29696.0, 0.00029 },{  30208.0, 0.00020 },
    {  30720.0, 0.00014 },{  31232.0, 0.00010 },{  31744.0, 0.00007 },{  32256.0, 0.00005 },
    {  32768.0, 0.00003 },{  33280.0, 0.00002 },{  33792.0, 0.00001 },{  34304.0, 0.00001 },
    {  34816.0, 0.00001 },{  35328.0, 0.00000 },{  35840.0, 0.00000 },{  36352.0, 0.00000 },
    {  36864.0, 0.00000 },{  37376.0, 0.00000 },{  37888.0, 0.00000 },{  38400.0, 0.00000 },
    {  38912.0, 0.00000 },{  39424.0, 0.00000 },{  39936.0, 0.00000 },{  40448.0, 0.00000 },
    {  40960.0, 0.00000 },{  41472.0, 0.00000 },{  41984.0, 0.00000 },{  42496.0, 0.00000 },
    {  43008.0, 0.00000 },{  43520.0, 0.00000 },{  44032.0, 0.00000 },{  44544.0, 0.00000 },
    {  45056.0, 0.00000 },{  45568.0, 0.00000 },{  46080.0, 0.00000 },{  46592.0, 0.00000 },
    {  47104.0, 0.00000 },{  47616.0, 0.00000 },{  48128.0, 0.00000 },{  48640.0, 0.00000 },
    {  49152.0, 0.00000 },{  49664.0, 0.00000 },{  50176.0, 0.00000 },{  50688.0, 0.00000 },
    {  51200.0, 0.00000 },{  51712.0, 0.00000 },{  52224.0, 0.00000 },{  52736.0, 0.00000 },
    {  53248.0, 0.00000 },{  53760.0, 0.00001 },{  54272.0, 0.00001 },{  54784.0, 0.00002 },
    {  55296.0, 0.00003 },{  55808.0, 0.00004 },{  56320.0, 0.00006 },{  56832.0, 0.00009 },
    {  57344.0, 0.00013 },{  57856.0, 0.00019 },{  58368.0, 0.00026 },{  58880.0, 0.00037 },
    {  59392.0, 0.00052 },{  59904.0, 0.00071 },{  60416.0, 0.00098 },{  60928.0, 0.00135 },
    {  61440.0, 0.00184 },{  61952.0, 0.00250 },{  62464.0, 0.00338 },{  62976.0, 0.00457 },
    {  63488.0, 0.00614 },{  64000.0, 0.00824 },{  64512.0, 0.01104 },{  65024.0, 0.01474 },
    {  65536.0, 0.01965 },{  66048.0, 0.02613 },{  66560.0, 0.03468 },{  67072.0, 0.04591 },
    {  67584.0, 0.06058 },{  68096.0, 0.07964 },{  68608.0, 0.10416 },{  69120.0, 0.13534 },
    {  69632.0, 0.17439 },{  70144.0, 0.22229 },{  70656.0, 0.27956 },{  71168.0, 0.34588 },
    {  71680.0, 0.41982 },{  72192.0, 0.49875 },{  72704.0, 0.57904 },{  73216.0, 0.65672 },
    {  73728.0, 0.72816 },{  74240.0, 0.79073 },{  74752.0, 0.84311 },{  75264.0, 0.88524 },
    {  75776.0, 0.91793 },{  76288.0, 0.94254 },{  76800.0, 0.96056 },{  77312.0, 0.97346 },
    {  77824.0, 0.98248 },{  78336.0, 0.98867 },{  78848.0, 0.99283 },{  79360.0, 0.99557 },
    {  79872.0, 0.99733 },{  80384.0, 0.99844 },{  80896.0, 0.99911 },{  81408.0, 0.99952 },
    {  81920.0, 0.99975 },{  82432.0, 0.99987 },{  82944.0, 0.99994 },{  83456.0, 0.99997 },
    {  83968.0, 0.99999 },{  84480.0, 1.00000 },{  84992.0, 1.00000 },{  85504.0, 1.00000 },
    {  86016.0, 1.00000 },{  86528.0, 1.00000 },{  87040.0, 1.00000 },{  87552.0, 1.00000 },
    {  88064.0, 1.00000 },{  88576.0, 1.00000 },{  89088.0, 1.00000 },{  89600.0, 1.00000 },
    {  90112.0, 1.00000 },{  90624.0, 1.00000 },{  91136.0, 1.00000 },{  91648.0, 1.00000 },
    {  92160.0, 0.99999 },{  92672.0, 0.99998 },{  93184.0, 0.99996 },{  93696.0, 0.99992 },
    {  94208.0, 0.99983 },{  94720.0, 0.99966 },{  95232.0, 0.99935 },{  95744.0, 0.99884 },
    {  96256.0, 0.99798 },{  96768.0, 0.99660 },{  97280.0, 0.99443 },{  97792.0, 0.99109 },
    {  98304.0, 0.98607 },{  98816.0, 0.97866 },{  99328.0, 0.96797 },{  99840.0, 0.95284 },
    { 100352.0, 0.93192 },{ 100864.0, 0.90370 },{ 101376.0, 0.86674 },{ 101888.0, 0.81986 },
    { 102400.0, 0.76262 },{ 102912.0, 0.69565 },{ 103424.0, 0.62089 },{ 103936.0, 0.54149 },
    { 104448.0, 0.46134 },{ 104960.0, 0.38435 },{ 105472.0, 0.31373 },{ 105984.0, 0.25155 },
    { 106496.0, 0.19869 },{ 107008.0, 0.15504 },{ 107520.0, 0.11982 },{ 108032.0, 0.09191 },
    { 108544.0, 0.07009 },{ 109056.0, 0.05322 },{ 109568.0, 0.04027 },{ 110080.0, 0.03038 },
    { 110592.0, 0.02287 },{ 111104.0, 0.01718 },{ 111616.0, 0.01287 },{ 112128.0, 0.00963 },
    { 112640.0, 0.00718 },{ 113152.0, 0.00535 },{ 113664.0, 0.00397 },{ 114176.0, 0.00294 },
    { 114688.0, 0.00217 },{ 115200.0, 0.00159 },{ 115712.0, 0.00116 },{ 116224.0, 0.00085 },
    { 116736.0, 0.00061 },{ 117248.0, 0.00044 },{ 117760.0, 0.00032 },{ 118272.0, 0.00022 },
    { 118784.0, 0.00016 },{ 119296.0, 0.00011 },{ 119808.0, 0.00008 },{ 120320.0, 0.00005 },
    { 120832.0, 0.00004 },{ 121344.0, 0.00002 },{ 121856.0, 0.00002 },{ 122368.0, 0.00001 },
    { 122880.0, 0.00001 },{ 123392.0, 0.00000 },{ 123904.0, 0.00000 },{ 124416.0, 0.00000 },
    { 124928.0, 0.00000 },{ 125440.0, 0.00000 },{ 125952.0, 0.00000 },{ 126464.0, 0.00000 },
    { 126976.0, 0.00000 },{ 127488.0, 0.00000 },{ 128000.0, 0.00000 },{ 128512.0, 0.00000 },
    { 129024.0, 0.00000 },{ 129536.0, 0.00000 },{ 130048.0, 0.00000 },{ 130560.0, 0.00000 },
};

// 4x oversampling, 4th order 16kHz Butterworth LPF (44.1kHz)
const std::vector<std::tuple<double, double>> TF::X4F1 = {
    {      0.0, 1.00000 },{    512.0, 1.00000 },{   1024.0, 1.00000 },{   1536.0, 1.00000 },
    {   2048.0, 1.00000 },{   2560.0, 1.00000 },{   3072.0, 1.00000 },{   3584.0, 1.00000 },
    {   4096.0, 0.99999 },{   4608.0, 0.99998 },{   5120.0, 0.99995 },{   5632.0, 0.99990 },
    {   6144.0, 0.99980 },{   6656.0, 0.99963 },{   7168.0, 0.99932 },{   7680.0, 0.99881 },
    {   8192.0, 0.99800 },{   8704.0, 0.99674 },{   9216.0, 0.99482 },{   9728.0, 0.99198 },
    {  10240.0, 0.98788 },{  10752.0, 0.98209 },{  11264.0, 0.97408 },{  11776.0, 0.96326 },
    {  12288.0, 0.94897 },{  12800.0, 0.93056 },{  13312.0, 0.90747 },{  13824.0, 0.87929 },
    {  14336.0, 0.84593 },{  14848.0, 0.80762 },{  15360.0, 0.76499 },{  15872.0, 0.71900 },
    {  16384.0, 0.67082 },{  16896.0, 0.62172 },{  17408.0, 0.57291 },{  17920.0, 0.52540 },
    {  18432.0, 0.48000 },{  18944.0, 0.43725 },{  19456.0, 0.39748 },{  19968.0, 0.36084 },
    {  20480.0, 0.32731 },{  20992.0, 0.29682 },{  21504.0, 0.26918 },{  22016.0, 0.24420 },
    {  22528.0, 0.22167 },{  23040.0, 0.20136 },{  23552.0, 0.18307 },{  24064.0, 0.16660 },
    {  24576.0, 0.15175 },{  25088.0, 0.13837 },{  25600.0, 0.12630 },{  26112.0, 0.11539 },
    {  26624.0, 0.10554 },{  27136.0, 0.09662 },{  27648.0, 0.08854 },{  28160.0, 0.08121 },
    {  28672.0, 0.07455 },{  29184.0, 0.06850 },{  29696.0, 0.06300 },{  30208.0, 0.05798 },
    {  30720.0, 0.05340 },{  31232.0, 0.04922 },{  31744.0, 0.04540 },{  32256.0, 0.04190 },
    {  32768.0, 0.03870 },{  33280.0, 0.03576 },{  33792.0, 0.03307 },{  34304.0, 0.03059 },
    {  34816.0, 0.02832 },{  35328.0, 0.02622 },{  35840.0, 0.02430 },{  36352.0, 0.02252 },
    {  36864.0, 0.02088 },{  37376.0, 0.01937 },{  37888.0, 0.01797 },{  38400.0, 0.01668 },
    {  38912.0, 0.01548 },{  39424.0, 0.01438 },{  39936.0, 0.01335 },{  40448.0, 0.01240 },
    {  40960.0, 0.01153 },{  41472.0, 0.01071 },{  41984.0, 0.00996 },{  42496.0, 0.00925 },
    {  43008.0, 0.00860 },{  43520.0, 0.00800 },{  44032.0, 0.00743 },{  44544.0, 0.00691 },
    {  45056.0, 0.00642 },{  45568.0, 0.00597 },{  46080.0, 0.00555 },{  46592.0, 0.00516 },
    {  47104.0, 0.00479 },{  47616.0, 0.00446 },{  48128.0, 0.00414 },{  48640.0, 0.00384 },
    {  49152.0, 0.00357 },{  49664.0, 0.00331 },{  50176.0, 0.00308 },{  50688.0, 0.00285 },
    {  51200.0, 0.00265 },{  51712.0, 0.00246 },{  52224.0, 0.00228 },{  52736.0, 0.00211 },
    {  53248.0, 0.00195 },{  53760.0, 0.00181 },{  54272.0, 0.00167 },{  54784.0, 0.00155 },
    {  55296.0, 0.00143 },{  55808.0, 0.00132 },{  56320.0, 0.00122 },{  56832.0, 0.00112 },
    {  57344.0, 0.00104 },{  57856.0, 0.00095 },{  58368.0, 0.00088 },{  58880.0, 0.00081 },
    {  59392.0, 0.00074 },{  59904.0, 0.00068 },{  60416.0, 0.00062 },{  60928.0, 0.00057 },
    {  61440.0, 0.00052 },{  61952.0, 0.00048 },{  62464.0, 0.00044 },{  62976.0, 0.00040 },
    {  63488.0, 0.00036 },{  64000.0, 0.00033 },{  64512.0, 0.00030 },{  65024.0, 0.00027 },
    {  65536.0, 0.00024 },{  66048.0, 0.00022 },{  66560.0, 0.00020 },{  67072.0, 0.00018 },
    {  67584.0, 0.00016 },{  68096.0, 0.00014 },{  68608.0, 0.00013 },{  69120.0, 0.00011 },
    {  69632.0, 0.00010 },{  70144.0, 0.00009 },{  70656.0, 0.00008 },{  71168.0, 0.00007 },
    {  71680.0, 0.00006 },{  72192.0, 0.00005 },{  72704.0, 0.00005 },{  73216.0, 0.00004 },
    {  73728.0, 0.00004 },{  74240.0, 0.00003 },{  74752.0, 0.00003 },{  75264.0, 0.00002 },
    {  75776.0, 0.00002 },{  76288.0, 0.00002 },{  76800.0, 0.00001 },{  77312.0, 0.00001 },
    {  77824.0, 0.00001 },{  78336.0, 0.00001 },{  78848.0, 0.00001 },{  79360.0, 0.00000 },
    {  79872.0, 0.00000 },{  80384.0, 0.00000 },{  80896.0, 0.00000 },{  81408.0, 0.00000 },
    {  81920.0, 0.00000 },{  82432.0, 0.00000 },{  82944.0, 0.00000 },{  83456.0, 0.00000 },
    {  83968.0, 0.00000 },{  84480.0, 0.00000 },{  84992.0, 0.00000 },{  85504.0, 0.00000 },
    {  86016.0, 0.00000 },{  86528.0, 0.00000 },{  87040.0, 0.00000 },{  87552.0, 0.00000 },
    {  88064.0, 0.00000 },{  88576.0, 0.00000 },{  89088.0, 0.00000 },{  89600.0, 0.00000 },
    {  90112.0, 0.00000 },{  90624.0, 0.00000 },{  91136.0, 0.00000 },{  91648.0, 0.00000 },
    {  92160.0, 0.00000 },{  92672.0, 0.00000 },{  93184.0, 0.00000 },{  93696.0, 0.00000 },
    {  94208.0, 0.00000 },{  94720.0, 0.00000 },{  95232.0, 0.00000 },{  95744.0, 0.00000 },
    {  96256.0, 0.00000 },{  96768.0, 0.00000 },{  97280.0, 0.00001 },{  97792.0, 0.00001 },
    {  98304.0, 0.00001 },{  98816.0, 0.00001 },{  99328.0, 0.00001 },{  99840.0, 0.00001 },
    { 100352.0, 0.00002 },{ 100864.0, 0.00002 },{ 101376.0, 0.00002 },{ 101888.0, 0.00003 },
    { 102400.0, 0.00003 },{ 102912.0, 0.00004 },{ 103424.0, 0.00004 },{ 103936.0, 0.00005 },
    { 104448.0, 0.00006 },{ 104960.0, 0.00007 },{ 105472.0, 0.00007 },{ 105984.0, 0.00008 },
    { 106496.0, 0.00010 },{ 107008.0, 0.00011 },{ 107520.0, 0.00012 },{ 108032.0, 0.00014 },
    { 108544.0, 0.00015 },{ 109056.0, 0.00017 },{ 109568.0, 0.00019 },{ 110080.0, 0.00021 },
    { 110592.0, 0.00023 },{ 111104.0, 0.00026 },{ 111616.0, 0.00028 },{ 112128.0, 0.00031 },
    { 112640.0, 0.00034 },{ 113152.0, 0.00038 },{ 113664.0, 0.00042 },{ 114176.0, 0.00046 },
    { 114688.0, 0.00050 },{ 115200.0, 0.00055 },{ 115712.0, 0.00060 },{ 116224.0, 0.00065 },
    { 116736.0, 0.00071 },{ 117248.0, 0.00077 },{ 117760.0, 0.00084 },{ 118272.0, 0.00091 },
    { 118784.0, 0.00099 },{ 119296.0, 0.00108 },{ 119808.0, 0.00117 },{ 120320.0, 0.00127 },
    { 120832.0, 0.00137 },{ 121344.0, 0.00148 },{ 121856.0, 0.00160 },{ 122368.0, 0.00173 },
    { 122880.0, 0.00187 },{ 123392.0, 0.00202 },{ 123904.0, 0.00219 },{ 124416.0, 0.00236 },
    { 124928.0, 0.00254 },{ 125440.0, 0.00274 },{ 125952.0, 0.00296 },{ 126464.0, 0.00319 },
    { 126976.0, 0.00343 },{ 127488.0, 0.00370 },{ 128000.0, 0.00398 },{ 128512.0, 0.00428 },
    { 129024.0, 0.00461 },{ 129536.0, 0.00496 },{ 130048.0, 0.00534 },{ 130560.0, 0.00574 },
};

// 4x oversampling, 2x4th order 16kHz Butterworth LPF (44.1kHz)
const std::vector<std::tuple<double, double>> TF::X4F2 = {
    {      0.0, 1.00000 },{    512.0, 1.00000 },{   1024.0, 1.00000 },{   1536.0, 1.00000 },
    {   2048.0, 1.00000 },{   2560.0, 1.00000 },{   3072.0, 1.00000 },{   3584.0, 0.99999 },
    {   4096.0, 0.99998 },{   4608.0, 0.99996 },{   5120.0, 0.99991 },{   5632.0, 0.99981 },
    {   6144.0, 0.99961 },{   6656.0, 0.99925 },{   7168.0, 0.99864 },{   7680.0, 0.99763 },
    {   8192.0, 0.99601 },{   8704.0, 0.99348 },{   9216.0, 0.98966 },{   9728.0, 0.98403 },
    {  10240.0, 0.97591 },{  10752.0, 0.96450 },{  11264.0, 0.94884 },{  11776.0, 0.92787 },
    {  12288.0, 0.90054 },{  12800.0, 0.86595 },{  13312.0, 0.82350 },{  13824.0, 0.77316 },
    {  14336.0, 0.71560 },{  14848.0, 0.65225 },{  15360.0, 0.58521 },{  15872.0, 0.51695 },
    {  16384.0, 0.45000 },{  16896.0, 0.38654 },{  17408.0, 0.32822 },{  17920.0, 0.27605 },
    {  18432.0, 0.23040 },{  18944.0, 0.19118 },{  19456.0, 0.15799 },{  19968.0, 0.13020 },
    {  20480.0, 0.10713 },{  20992.0, 0.08810 },{  21504.0, 0.07246 },{  22016.0, 0.05963 },
    {  22528.0, 0.04914 },{  23040.0, 0.04055 },{  23552.0, 0.03351 },{  24064.0, 0.02775 },
    {  24576.0, 0.02303 },{  25088.0, 0.01915 },{  25600.0, 0.01595 },{  26112.0, 0.01332 },
    {  26624.0, 0.01114 },{  27136.0, 0.00933 },{  27648.0, 0.00784 },{  28160.0, 0.00659 },
    {  28672.0, 0.00556 },{  29184.0, 0.00469 },{  29696.0, 0.00397 },{  30208.0, 0.00336 },
    {  30720.0, 0.00285 },{  31232.0, 0.00242 },{  31744.0, 0.00206 },{  32256.0, 0.00176 },
    {  32768.0, 0.00150 },{  33280.0, 0.00128 },{  33792.0, 0.00109 },{  34304.0, 0.00094 },
    {  34816.0, 0.00080 },{  35328.0, 0.00069 },{  35840.0, 0.00059 },{  36352.0, 0.00051 },
    {  36864.0, 0.00044 },{  37376.0, 0.00038 },{  37888.0, 0.00032 },{  38400.0, 0.00028 },
    {  38912.0, 0.00024 },{  39424.0, 0.00021 },{  39936.0, 0.00018 },{  40448.0, 0.00015 },
    {  40960.0, 0.00013 },{  41472.0, 0.00011 },{  41984.0, 0.00010 },{  42496.0, 0.00009 },
    {  43008.0, 0.00007 },{  43520.0, 0.00006 },{  44032.0, 0.00006 },{  44544.0, 0.00005 },
    {  45056.0, 0.00004 },{  45568.0, 0.00004 },{  46080.0, 0.00003 },{  46592.0, 0.00003 },
    {  47104.0, 0.00002 },{  47616.0, 0.00002 },{  48128.0, 0.00002 },{  48640.0, 0.00001 },
    {  49152.0, 0.00001 },{  49664.0, 0.00001 },{  50176.0, 0.00001 },{  50688.0, 0.00001 },
    {  51200.0, 0.00001 },{  51712.0, 0.00001 },{  52224.0, 0.00001 },{  52736.0, 0.00000 },
    {  53248.0, 0.00000 },{  53760.0, 0.00000 },{  54272.0, 0.00000 },{  54784.0, 0.00000 },
    {  55296.0, 0.00000 },{  55808.0, 0.00000 },{  56320.0, 0.00000 },{  56832.0, 0.00000 },
    {  57344.0, 0.00000 },{  57856.0, 0.00000 },{  58368.0, 0.00000 },{  58880.0, 0.00000 },
    {  59392.0, 0.00000 },{  59904.0, 0.00000 },{  60416.0, 0.00000 },{  60928.0, 0.00000 },
    {  61440.0, 0.00000 },{  61952.0, 0.00000 },{  62464.0, 0.00000 },{  62976.0, 0.00000 },
    {  63488.0, 0.00000 },{  64000.0, 0.00000 },{  64512.0, 0.00000 },{  65024.0, 0.00000 },
    {  65536.0, 0.00000 },{  66048.0, 0.00000 },{  66560.0, 0.00000 },{  67072.0, 0.00000 },
    {  67584.0, 0.00000 },{  68096.0, 0.00000 },{  68608.0, 0.00000 },{  69120.0, 0.00000 },
    {  69632.0, 0.00000 },{  70144.0, 0.00000 },{  70656.0, 0.00000 },{  71168.0, 0.00000 },
    {  71680.0, 0.00000 },{  72192.0, 0.00000 },{  72704.0, 0.00000 },{  73216.0, 0.00000 },
    {  73728.0, 0.00000 },{  74240.0, 0.00000 },{  74752.0, 0.00000 },{  75264.0, 0.00000 },
    {  75776.0, 0.00000 },{  76288.0, 0.00000 },{  76800.0, 0.00000 },{  77312.0, 0.00000 },
    {  77824.0, 0.00000 },{  78336.0, 0.00000 },{  78848.0, 0.00000 },{  79360.0, 0.00000 },
    {  79872.0, 0.00000 },{  80384.0, 0.00000 },{  80896.0, 0.00000 },{  81408.0, 0.00000 },
    {  81920.0, 0.00000 },{  82432.0, 0.00000 },{  82944.0, 0.00000 },{  83456.0, 0.00000 },
    {  83968.0, 0.00000 },{  84480.0, 0.00000 },{  84992.0, 0.00000 },{  85504.0, 0.00000 },
    {  86016.0, 0.00000 },{  86528.0, 0.00000 },{  87040.0, 0.00000 },{  87552.0, 0.00000 },
    {  88064.0, 0.00000 },{  88576.0, 0.00000 },{  89088.0, 0.00000 },{  89600.0, 0.00000 },
    {  90112.0, 0.00000 },{  90624.0, 0.00000 },{  91136.0, 0.00000 },{  91648.0, 0.00000 },
    {  92160.0, 0.00000 },{  92672.0, 0.00000 },{  93184.0, 0.00000 },{  93696.0, 0.00000 },
    {  94208.0, 0.00000 },{  94720.0, 0.00000 },{  95232.0, 0.00000 },{  95744.0, 0.00000 },
    {  96256.0, 0.00000 },{  96768.0, 0.00000 },{  97280.0, 0.00000 },{  97792.0, 0.00000 },
    {  98304.0, 0.00000 },{  98816.0, 0.00000 },{  99328.0, 0.00000 },{  99840.0, 0.00000 },
    { 100352.0, 0.00000 },{ 100864.0, 0.00000 },{ 101376.0, 0.00000 },{ 101888.0, 0.00000 },
    { 102400.0, 0.00000 },{ 102912.0, 0.00000 },{ 103424.0, 0.00000 },{ 103936.0, 0.00000 },
    { 104448.0, 0.00000 },{ 104960.0, 0.00000 },{ 105472.0, 0.00000 },{ 105984.0, 0.00000 },
    { 106496.0, 0.00000 },{ 107008.0, 0.00000 },{ 107520.0, 0.00000 },{ 108032.0, 0.00000 },
    { 108544.0, 0.00000 },{ 109056.0, 0.00000 },{ 109568.0, 0.00000 },{ 110080.0, 0.00000 },
    { 110592.0, 0.00000 },{ 111104.0, 0.00000 },{ 111616.0, 0.00000 },{ 112128.0, 0.00000 },
    { 112640.0, 0.00000 },{ 113152.0, 0.00000 },{ 113664.0, 0.00000 },{ 114176.0, 0.00000 },
    { 114688.0, 0.00000 },{ 115200.0, 0.00000 },{ 115712.0, 0.00000 },{ 116224.0, 0.00000 },
    { 116736.0, 0.00000 },{ 117248.0, 0.00000 },{ 117760.0, 0.00000 },{ 118272.0, 0.00000 },
    { 118784.0, 0.00000 },{ 119296.0, 0.00000 },{ 119808.0, 0.00000 },{ 120320.0, 0.00000 },
    { 120832.0, 0.00000 },{ 121344.0, 0.00000 },{ 121856.0, 0.00000 },{ 122368.0, 0.00000 },
    { 122880.0, 0.00000 },{ 123392.0, 0.00000 },{ 123904.0, 0.00000 },{ 124416.0, 0.00001 },
    { 124928.0, 0.00001 },{ 125440.0, 0.00001 },{ 125952.0, 0.00001 },{ 126464.0, 0.00001 },
    { 126976.0, 0.00001 },{ 127488.0, 0.00001 },{ 128000.0, 0.00002 },{ 128512.0, 0.00002 },
    { 129024.0, 0.00002 },{ 129536.0, 0.00002 },{ 130048.0, 0.00003 },{ 130560.0, 0.00003 },
};
// clang-format on