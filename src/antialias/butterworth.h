#pragma once

#include <map>
#include <vector>
#include <tuple>

struct IIR {
    const double a[4];
    const double b[5];
};

// 12.5kHz, 4 pole Butterworth LPF
const std::map<int, IIR> COEFFICIENTS_12500Hz = {
    {
        11025,
        IIR{
            .a = {-0.000000, 0.486029, -0.000000, 0.017665},
            .b = {0.093981, 0.375923, 0.563885, 0.375923, 0.093981}
        },
    },
    {
        12000,
        IIR{
            .a = {-0.000000, 0.486029, -0.000000, 0.017665},
            .b = {0.093981, 0.375923, 0.563885, 0.375923, 0.093981}
        },
    },
    {
        22050,
        IIR{
            .a = {-0.000000, 0.486029, -0.000000, 0.017665},
            .b = {0.093981, 0.375923, 0.563885, 0.375923, 0.093981}
        },
    },
    {
        24000,
        IIR{
            .a = {-0.000000, 0.486029, -0.000000, 0.017665},
            .b = {0.093981, 0.375923, 0.563885, 0.375923, 0.093981}
        },
    },
    {
        44100,
        IIR{
            .a = {0.522771, 0.572532, 0.115179, 0.023070},
            .b = {0.139597, 0.558388, 0.837582, 0.558388, 0.139597}
        },
    },
    {
        48000,
        IIR{
            .a = {0.162720, 0.494399, 0.034292, 0.018177},
            .b = {0.106849, 0.427397, 0.641096, 0.427397, 0.106849}
        },
    },
    {
        88200,
        IIR{
            .a = {-1.701848, 1.415432, -0.555482, 0.088803},
            .b = {0.015432, 0.061726, 0.092589, 0.061726, 0.015432}
        },
    },
    {
        96000,
        IIR{
            .a = {-1.885259, 1.630530, -0.667897, 0.109585},
            .b = {0.011685, 0.046740, 0.070109, 0.046740, 0.011685}
        },
    },
    {
        176400,
        IIR{
            .a = {-2.840868, 3.148688, -1.593312, 0.308840},
            .b = {0.001459, 0.005837, 0.008756, 0.005837, 0.001459}
        },
    },
    {
        192000,
        IIR{
            .a = {-2.934464, 3.335403, -1.724001, 0.340343},
            .b = {0.001080, 0.004320, 0.006480, 0.004320, 0.001080}
        },
    },
    {
        352800,
        IIR{
            .a = {-3.418841, 4.419496, -2.556930, 0.558141},
            .b = {0.000117, 0.000466, 0.000700, 0.000466, 0.000117}
        },
    },
    {
        384000,
        IIR{
            .a = {-3.465980, 4.535945, -2.653948, 0.585341},
            .b = {0.000085, 0.000339, 0.000509, 0.000339, 0.000085}
        },
    },
    {
        705600,
        IIR{
            .a = {-3.709207, 5.169158, -3.207302, 0.747485},
            .b = {0.000008, 0.000033, 0.000050, 0.000033, 0.000008}
        },
    },
    {
        768000,
        IIR{
            .a = {-3.732824, 5.233586, -3.266057, 0.765391},
            .b = {0.000006, 0.000024, 0.000036, 0.000024, 0.000006}
        },
    },
    {
        1411200,
        IIR{
            .a = {-3.854577, 5.574210, -3.584254, 0.864629},
            .b = {0.000001, 0.000002, 0.000003, 0.000002, 0.000001}
        },
    },
    {
        1536000,
        IIR{
            .a = {-3.866391, 5.608026, -3.616540, 0.874911},
            .b = {0.000000, 0.000002, 0.000002, 0.000002, 0.000000}
        },
    },
    {
        2822400,
        IIR{
            .a = {-3.927285, 5.784487, -3.787063, 0.929862},
            .b = {0.000000, 0.000000, 0.000000, 0.000000, 0.000000}
        },
    },
    {
        3072000,
        IIR{
            .a = {-3.933193, 5.801801, -3.803980, 0.935373},
            .b = {0.000000, 0.000000, 0.000000, 0.000000, 0.000000}
        },
    },
};

// 16kHz, 4 pole Butterworth LPF
const std::map<int, IIR> COEFFICIENTS_16kHz = {
    {
        11025,
        IIR{
            .a = {0.782095, 0.679979, 0.182676, 0.030119},
            .b = {0.167179, 0.668717, 1.003076, 0.668717, 0.167179}
        },
    },
    {
        12000,
        IIR{
            .a = {0.782095, 0.679979, 0.182676, 0.030119},
            .b = {0.167179, 0.668717, 1.003076, 0.668717, 0.167179}
        },
    },
    {
        22050,
        IIR{
            .a = {0.782095, 0.679979, 0.182676, 0.030119},
            .b = {0.167179, 0.668717, 1.003076, 0.668717, 0.167179}
        },
    },
    {
        24000,
        IIR{
            .a = {0.782095, 0.679979, 0.182676, 0.030119},
            .b = {0.167179, 0.668717, 1.003076, 0.668717, 0.167179}
        },
    },
    {
        44100,
        IIR{
            .a = {1.774009, 1.497258, 0.597776, 0.096508},
            .b = {0.310347, 1.241388, 1.862081, 1.241388, 0.310347}
        },
    },
    {
        48000,
        IIR{
            .a = {1.306605, 1.030454, 0.362369, 0.055764},
            .b = {0.234699, 0.938798, 1.408197, 0.938798, 0.234699}
        },
    },
    {
        88200,
        IIR{
            .a = {-1.074228, 0.852962, -0.274000, 0.042262},
            .b = {0.034187, 0.136749, 0.205124, 0.136749, 0.034187}
        },
    },
    {
        96000,
        IIR{
            .a = {-1.306605, 1.030454, -0.362369, 0.055764},
            .b = {0.026078, 0.104311, 0.156466, 0.104311, 0.026078}
        },
    },
    {
        176400,
        IIR{
            .a = {-2.519465, 2.560837, -1.206235, 0.220129},
            .b = {0.003454, 0.013817, 0.020725, 0.013817, 0.003454}
        },
    },
    {
        192000,
        IIR{
            .a = {-2.638628, 2.769310, -1.339281, 0.249822},
            .b = {0.002576, 0.010306, 0.015459, 0.010306, 0.002576}
        },
    },
    {
        352800,
        IIR{
            .a = {-3.256569, 4.033768, -2.246044, 0.473506},
            .b = {0.000291, 0.001165, 0.001748, 0.001165, 0.000291}
        },
    },
    {
        384000,
        IIR{
            .a = {-3.316808, 4.174246, -2.357403, 0.503375},
            .b = {0.000213, 0.000853, 0.001279, 0.000853, 0.000213}
        },
    },
    {
        705600,
        IIR{
            .a = {-3.627844, 4.951225, -3.011924, 0.688888},
            .b = {0.000022, 0.000086, 0.000129, 0.000086, 0.000022}
        },
    },
    {
        768000,
        IIR{
            .a = {-3.658060, 5.031434, -3.083228, 0.710104},
            .b = {0.000016, 0.000062, 0.000093, 0.000062, 0.000016}
        },
    },
    {
        1411200,
        IIR{
            .a = {-3.813865, 5.458724, -3.474943, 0.830108},
            .b = {0.000001, 0.000006, 0.000009, 0.000006, 0.000001}
        },
    },
    {
        1536000,
        IIR{
            .a = {-3.828986, 5.501430, -3.515194, 0.842767},
            .b = {0.000001, 0.000004, 0.000006, 0.000004, 0.000001}
        },
    },
    {
        2822400,
        IIR{
            .a = {-3.906926, 5.725084, -3.729275, 0.911118},
            .b = {0.000000, 0.000000, 0.000001, 0.000000, 0.000000}
        },
    },
    {
        3072000,
        IIR{
            .a = {-3.914488, 5.747100, -3.750647, 0.918036},
            .b = {0.000000, 0.000000, 0.000000, 0.000000, 0.000000}
        },
    },
};


// 12.5kHz, 4 pole Butterworth LPF transfer function (44.1kHz)
const std::vector<std::tuple<double, double>> TF_12500Hz = {
    {     0.00000, 1.00000 },{   344.53125, 1.00000 },{   689.06250, 1.00000 },{  1033.59375, 1.00000 },
    {  1378.12500, 1.00000 },{  1722.65625, 1.00000 },{  2067.18750, 1.00000 },{  2411.71875, 1.00000 },
    {  2756.25000, 1.00000 },{  3100.78125, 1.00000 },{  3445.31250, 1.00000 },{  3789.84375, 1.00000 },
    {  4134.37500, 0.99999 },{  4478.90625, 0.99999 },{  4823.43750, 0.99998 },{  5167.96875, 0.99995 },
    {  5512.50000, 0.99992 },{  5857.03125, 0.99986 },{  6201.56250, 0.99977 },{  6546.09375, 0.99962 },
    {  6890.62500, 0.99939 },{  7235.15625, 0.99903 },{  7579.68750, 0.99847 },{  7924.21875, 0.99763 },
    {  8268.75000, 0.99637 },{  8613.28125, 0.99448 },{  8957.81250, 0.99169 },{  9302.34375, 0.98759 },
    {  9646.87500, 0.98161 },{  9991.40625, 0.97296 },{ 10335.93750, 0.96060 },{ 10680.46875, 0.94318 },
    { 11025.00000, 0.91908 },{ 11369.53125, 0.88656 },{ 11714.06250, 0.84404 },{ 12058.59375, 0.79065 },
    { 12403.12500, 0.72674 },{ 12747.65625, 0.65426 },{ 13092.18750, 0.57655 },{ 13436.71875, 0.49770 },
    { 13781.25000, 0.42157 },{ 14125.78125, 0.35115 },{ 14470.31250, 0.28824 },{ 14814.84375, 0.23355 },
    { 15159.37500, 0.18702 },{ 15503.90625, 0.14807 },{ 15848.43750, 0.11592 },{ 16192.96875, 0.08968 },
    { 16537.50000, 0.06850 },{ 16882.03125, 0.05157 },{ 17226.56250, 0.03820 },{ 17571.09375, 0.02777 },
    { 17915.62500, 0.01975 },{ 18260.15625, 0.01368 },{ 18604.68750, 0.00918 },{ 18949.21875, 0.00593 },
    { 19293.75000, 0.00365 },{ 19638.28125, 0.00211 },{ 19982.81250, 0.00113 },{ 20327.34375, 0.00054 },
    { 20671.87500, 0.00022 },{ 21016.40625, 0.00007 },{ 21360.93750, 0.00001 },{ 21705.46875, 0.00000 },
    { 22050.00000, 0.00000 },{ 22394.53125, 0.00000 },{ 22739.06250, 0.00001 },{ 23083.59375, 0.00007 },
    { 23428.12500, 0.00022 },{ 23772.65625, 0.00054 },{ 24117.18750, 0.00113 },{ 24461.71875, 0.00211 },
    { 24806.25000, 0.00365 },{ 25150.78125, 0.00593 },{ 25495.31250, 0.00918 },{ 25839.84375, 0.01368 },
    { 26184.37500, 0.01975 },{ 26528.90625, 0.02777 },{ 26873.43750, 0.03820 },{ 27217.96875, 0.05157 },
    { 27562.50000, 0.06850 },{ 27907.03125, 0.08968 },{ 28251.56250, 0.11592 },{ 28596.09375, 0.14807 },
    { 28940.62500, 0.18702 },{ 29285.15625, 0.23355 },{ 29629.68750, 0.28824 },{ 29974.21875, 0.35115 },
    { 30318.75000, 0.42157 },{ 30663.28125, 0.49770 },{ 31007.81250, 0.57655 },{ 31352.34375, 0.65426 },
    { 31696.87500, 0.72674 },{ 32041.40625, 0.79065 },{ 32385.93750, 0.84404 },{ 32730.46875, 0.88656 },
    { 33075.00000, 0.91908 },{ 33419.53125, 0.94318 },{ 33764.06250, 0.96060 },{ 34108.59375, 0.97296 },
    { 34453.12500, 0.98161 },{ 34797.65625, 0.98759 },{ 35142.18750, 0.99169 },{ 35486.71875, 0.99448 },
    { 35831.25000, 0.99637 },{ 36175.78125, 0.99763 },{ 36520.31250, 0.99847 },{ 36864.84375, 0.99903 },
    { 37209.37500, 0.99939 },{ 37553.90625, 0.99962 },{ 37898.43750, 0.99977 },{ 38242.96875, 0.99986 },
    { 38587.50000, 0.99992 },{ 38932.03125, 0.99995 },{ 39276.56250, 0.99998 },{ 39621.09375, 0.99999 },
    { 39965.62500, 0.99999 },{ 40310.15625, 1.00000 },{ 40654.68750, 1.00000 },{ 40999.21875, 1.00000 },
    { 41343.75000, 1.00000 },{ 41688.28125, 1.00000 },{ 42032.81250, 1.00000 },{ 42377.34375, 1.00000 },
    { 42721.87500, 1.00000 },{ 43066.40625, 1.00000 },{ 43410.93750, 1.00000 },{ 43755.46875, 1.00000 },
};

// 16kHz, 4 pole Butterworth LPF transfer function (44.1kHz)
const std::vector<std::tuple<double, double>> TF_16kHz = {
    {     0.00000, 1.00000 },{   344.53125, 1.00000 },{   689.06250, 1.00000 },{  1033.59375, 1.00000 },
    {  1378.12500, 1.00000 },{  1722.65625, 1.00000 },{  2067.18750, 1.00000 },{  2411.71875, 1.00000 },
    {  2756.25000, 1.00000 },{  3100.78125, 1.00000 },{  3445.31250, 1.00000 },{  3789.84375, 1.00000 },
    {  4134.37500, 1.00000 },{  4478.90625, 1.00000 },{  4823.43750, 1.00000 },{  5167.96875, 1.00000 },
    {  5512.50000, 1.00000 },{  5857.03125, 1.00000 },{  6201.56250, 1.00000 },{  6546.09375, 1.00000 },
    {  6890.62500, 0.99999 },{  7235.15625, 0.99999 },{  7579.68750, 0.99998 },{  7924.21875, 0.99997 },
    {  8268.75000, 0.99996 },{  8613.28125, 0.99994 },{  8957.81250, 0.99991 },{  9302.34375, 0.99986 },
    {  9646.87500, 0.99979 },{  9991.40625, 0.99969 },{ 10335.93750, 0.99955 },{ 10680.46875, 0.99933 },
    { 11025.00000, 0.99900 },{ 11369.53125, 0.99852 },{ 11714.06250, 0.99781 },{ 12058.59375, 0.99676 },
    { 12403.12500, 0.99518 },{ 12747.65625, 0.99282 },{ 13092.18750, 0.98926 },{ 13436.71875, 0.98389 },
    { 13781.25000, 0.97576 },{ 14125.78125, 0.96346 },{ 14470.31250, 0.94492 },{ 14814.84375, 0.91731 },
    { 15159.37500, 0.87708 },{ 15503.90625, 0.82063 },{ 15848.43750, 0.74575 },{ 16192.96875, 0.65361 },
    { 16537.50000, 0.54996 },{ 16882.03125, 0.44382 },{ 17226.56250, 0.34423 },{ 17571.09375, 0.25745 },
    { 17915.62500, 0.18610 },{ 18260.15625, 0.13008 },{ 18604.68750, 0.08772 },{ 18949.21875, 0.05679 },
    { 19293.75000, 0.03500 },{ 19638.28125, 0.02027 },{ 19982.81250, 0.01083 },{ 20327.34375, 0.00518 },
    { 20671.87500, 0.00210 },{ 21016.40625, 0.00066 },{ 21360.93750, 0.00013 },{ 21705.46875, 0.00001 },
    { 22050.00000, 0.00000 },{ 22394.53125, 0.00001 },{ 22739.06250, 0.00013 },{ 23083.59375, 0.00066 },
    { 23428.12500, 0.00210 },{ 23772.65625, 0.00518 },{ 24117.18750, 0.01083 },{ 24461.71875, 0.02027 },
    { 24806.25000, 0.03500 },{ 25150.78125, 0.05679 },{ 25495.31250, 0.08772 },{ 25839.84375, 0.13008 },
    { 26184.37500, 0.18610 },{ 26528.90625, 0.25745 },{ 26873.43750, 0.34423 },{ 27217.96875, 0.44382 },
    { 27562.50000, 0.54996 },{ 27907.03125, 0.65361 },{ 28251.56250, 0.74575 },{ 28596.09375, 0.82063 },
    { 28940.62500, 0.87708 },{ 29285.15625, 0.91731 },{ 29629.68750, 0.94492 },{ 29974.21875, 0.96346 },
    { 30318.75000, 0.97576 },{ 30663.28125, 0.98389 },{ 31007.81250, 0.98926 },{ 31352.34375, 0.99282 },
    { 31696.87500, 0.99518 },{ 32041.40625, 0.99676 },{ 32385.93750, 0.99781 },{ 32730.46875, 0.99852 },
    { 33075.00000, 0.99900 },{ 33419.53125, 0.99933 },{ 33764.06250, 0.99955 },{ 34108.59375, 0.99969 },
    { 34453.12500, 0.99979 },{ 34797.65625, 0.99986 },{ 35142.18750, 0.99991 },{ 35486.71875, 0.99994 },
    { 35831.25000, 0.99996 },{ 36175.78125, 0.99997 },{ 36520.31250, 0.99998 },{ 36864.84375, 0.99999 },
    { 37209.37500, 0.99999 },{ 37553.90625, 1.00000 },{ 37898.43750, 1.00000 },{ 38242.96875, 1.00000 },
    { 38587.50000, 1.00000 },{ 38932.03125, 1.00000 },{ 39276.56250, 1.00000 },{ 39621.09375, 1.00000 },
    { 39965.62500, 1.00000 },{ 40310.15625, 1.00000 },{ 40654.68750, 1.00000 },{ 40999.21875, 1.00000 },
    { 41343.75000, 1.00000 },{ 41688.28125, 1.00000 },{ 42032.81250, 1.00000 },{ 42377.34375, 1.00000 },
    { 42721.87500, 1.00000 },{ 43066.40625, 1.00000 },{ 43410.93750, 1.00000 },{ 43755.46875, 1.00000 },
};


extern IIR coefficients(const std::map<int, IIR>& table, float fs);
